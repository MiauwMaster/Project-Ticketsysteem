
@using iTextSharp.text;
@using iTextSharp.text.pdf;
@using QRCoder;
@{
        //Variables
        var artiest = "";
        var foto = "";
        var datum = "";
        var zaal = "";
        var prijs = 0;

        // Open database connection
        var db = Database.Open("Database");

        //SQL Statement
        var statement = "SELECT * FROM Concerten WHERE id = @0";
        var data = db.QuerySingle(statement, /*TODO: Add id from last page*/);

        var statement2 = "";

        //Fill variables
        artiest = data.naam;
        foto = data.foto;
        datum = data.datum;
        zaal = data.zaal_nr;
        prijs = data.prijs;


        renderQRCode();

        Document doc = new Document();
        try
        {
            PdfWriter.GetInstance(doc, new FileStream("C:/users/muize/screenshots/pdfjes.pdf", FileMode.Create));
            doc.Open();


            var titleFont = FontFactory.GetFont("Verdana", 40, BaseColor.BLACK);
            var parFont = FontFactory.GetFont("Verdana", 15, BaseColor.BLACK);
            var paragraph1 = new Paragraph("Uw ticket", titleFont);
            paragraph1.Alignment = Element.ALIGN_CENTER;
            doc.Add(paragraph1);
            var line = new Paragraph("______________________", titleFont);
            line.Alignment = Element.ALIGN_CENTER;
            doc.Add(line);
            iTextSharp.text.Image jpg = iTextSharp.text.Image.GetInstance(renderQRCode(), BaseColor.WHITE);
            doc.Add(jpg);
            var paragraph2 = new Paragraph(hoi, parFont);
            doc.Add(paragraph2);
            iTextSharp.text.Image artist = iTextSharp.text.Image.GetInstance("C:/users/muize/screenshots/1.jpg");
            doc.Add(artist);

        }

        catch (Exception ex)
        {
            //Log error;
        }
        finally
        {
            doc.Close();
        } 

    private static System.Drawing.Image renderQRCode()
    {
        QRCodeGenerator qrGenerator = new QRCodeGenerator();
        QRCodeData qrCodeData = qrGenerator.CreateQrCode("TODO: URL invoegen", QRCodeGenerator.ECCLevel.Q);
        QRCode qrCode = new QRCode(qrCodeData);
        System.Drawing.Image qrCodeImage = qrCode.GetGraphic(5);
        return qrCodeImage;
    }
}
